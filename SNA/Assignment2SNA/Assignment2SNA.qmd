---
title: "Assignment 2 SNA"
author: "Marc Sparhuber"
format: pdf
editor: source
execute:
  warning: false
  echo: false
toc: true
header-includes:
      - \usepackage{float}
      - \floatplacement{table}{H}
---

## Task 1 & Packages

Formulate theoretical arguments and expectations about interstate relations. Think in network terms. Select the appropriate part of the data for analysis.

```{r}
library(tidyverse)
library(igraph)

#data <- read_csv("C:/Users/User/Desktop/Labs and Assignments Winter early 24/CSS_Labs_early_24/SNA/Assignment2SNA/terr-changes-v6/tc2018.csv")
data <- read_csv("C:/Users/marcs/Desktop/Labs/CSS_Labs_early_24/SNA/Assignment2SNA/terr-changes-v6/tc2018.csv")
#country_codes <- read.csv("C:/Users/User/Desktop/Labs and Assignments Winter early 24/CSS_Labs_early_24/SNA/Assignment2SNA/COW-country-codes.csv")
country_codes <- read.csv("C:/Users/marcs/Desktop/Labs/CSS_Labs_early_24/SNA/Assignment2SNA/COW-country-codes.csv")

country_codes_gain <- country_codes |> rename(gainer = CCode) |> select(-StateAbb) |> distinct()
country_codes_entity <- country_codes |> rename(entity = CCode) |> select(-StateAbb) |> distinct()
country_codes_loser <- country_codes |> rename(loser = CCode) |> select(-StateAbb) |> distinct()

data$entity <- as.numeric(data$entity)

data <- data |> left_join(country_codes_gain, join_by(gainer)) |> select(-gainer) |> rename(gainer = StateNme) |>
  left_join(country_codes_entity, join_by(entity)) |> select(-entity) |> rename(entity = StateNme) |>
  left_join(country_codes_loser, join_by(loser)) |> select(-loser) |> rename(loser = StateNme) |> 
  relocate(any_of(c("gainer", "loser", "entity")), .before = year) |> select(-version) |> drop_na(any_of(c("gainer", "loser")))

North_America <- c("United States of America", "Canada", "Bahamas", "Cuba", "Haiti", "Dominican Republic", "Jamaica", "Trinidad and Tobago", "Barbados", "Dominica", "Grenada", "St. Lucia", "St. Vincent and the Grenadines", "Antigua & Barbuda", "St. Kitts and Nevis", "Mexico", "Belize", "Guatemala", "Honduras", "El Salvador", "Nicaragua", "Costa Rica", "Panama")

South_America <- c("Colombia", "Venezuela", "Guyana", "Suriname", "Ecuador", "Peru", "Brazil", "Bolivia", "Paraguay", "Chile", "Argentina", "Uruguay")

Europe <- c("United Kingdom", "Ireland", "Netherlands", "Belgium", "Luxembourg", "France", "Monaco", "Liechtenstein", "Switzerland", "Spain", "Andorra", "Portugal", "Hanover", "Bavaria", "Germany", "German Federal Republic", "German Democratic Republic", "Baden", "Saxony", "Wuerttemburg", "Hesse Electoral", "Hesse Grand Ducal", "Mecklenburg Schwerin", "Poland", "Austria-Hungary", "Austria", "Hungary", "Czechoslovakia", "Czech Republic", "Slovakia", "Italy", "Papal States", "Two Sicilies", "San Marino", "Modena", "Parma", "Tuscany", "Malta", "Albania", "Montenegro", "Macedonia", "Croatia", "Yugoslavia", "Bosnia and Herzegovina", "Kosovo", "Slovenia", "Greece", "Cyprus", "Bulgaria", "Moldova", "Romania", "Russia", "Estonia", "Latvia", "Lithuania", "Ukraine", "Belarus", "Armenia", "Georgia", "Azerbaijan", "Finland", "Sweden", "Norway", "Denmark", "Iceland")

Africa <- c("Cape Verde", "Sao Tome and Principe", "Guinea-Bissau", "Equatorial Guinea", "Gambia", "Mali", "Senegal", "Benin", "Mauritania", "Niger", "Ivory Coast", "Guinea", "Burkina Faso", "Liberia", "Sierra Leone", "Ghana", "Togo", "Cameroon", "Nigeria", "Gabon", "Central African Republic", "Chad", "Congo", "Democratic Republic of the Congo", "Uganda", "Kenya", "Tanzania", "Zanzibar", "Burundi", "Rwanda", "Somalia", "Djibouti", "Ethiopia", "Eritrea", "Angola", "Mozambique", "Zambia", "Zimbabwe", "Malawi", "South Africa", "Namibia", "Lesotho", "Botswana", "Swaziland", "Madagascar", "Comoros", "Mauritius", "Seychelles", "Morocco", "Algeria", "Tunisia", "Libya", "Sudan", "South Sudan", "Egypt")

Asia <- c("Turkmenistan", "Tajikistan", "Kyrgyzstan", "Uzbekistan", "Kazakhstan", "China", "Mongolia", "Taiwan", "Korea", "North Korea", "South Korea", "Japan", "India", "Bhutan", "Pakistan", "Bangladesh", "Myanmar", "Sri Lanka", "Maldives", "Nepal", "Thailand", "Cambodia", "Laos", "Vietnam", "Republic of Vietnam", "Malaysia", "Singapore", "Brunei", "Philippines", "Indonesia", "East Timor")

Middle_East <- c("Iran", "Turkey", "Iraq", "Syria", "Lebanon", "Jordan", "Israel", "Saudi Arabia", "Yemen Arab Republic", "Yemen", "Yemen People's Republic", "Kuwait", "Bahrain", "Qatar", "United Arab Emirates", "Oman", "Afghanistan")

Oceania <- c("Australia", "Papua New Guinea", "New Zealand", "Vanuatu", "Solomon Islands", "Kiribati", "Tuvalu", "Fiji", "Tonga", "Nauru", "Marshall Islands", "Palau", "Federated States of Micronesia", "Samoa")

Southeast_Asia <- c("Thailand", "Cambodia", "Laos", "Vietnam", "Republic of Vietnam", "Malaysia", "Singapore", "Brunei", "Philippines", "Indonesia", "East Timor", "Myanmar")

Island_States <- c(
    "Bahamas", "Cuba", "Haiti", "Dominican Republic", "Jamaica",
    "Trinidad and Tobago", "Barbados", "Dominica", "Grenada", "St. Lucia",
    "St. Vincent and the Grenadines", "Antigua & Barbuda", "St. Kitts and Nevis",
    "Sao Tome and Principe", "Guinea-Bissau", "Equatorial Guinea", "Gambia",
    "Cape Verde", "Comoros", "Mauritius", "Seychelles", "Maldives",
    "Sri Lanka", "Indonesia", "East Timor", "Australia", "Papua New Guinea",
    "New Zealand", "Vanuatu", "Solomon Islands", "Kiribati", "Tuvalu",
    "Fiji", "Tonga", "Nauru", "Marshall Islands", "Palau",
    "Federated States of Micronesia", "Samoa"
)

data <- data |> 
  rowwise() |> 
  mutate(
    contains_oceanic = if_any(c(gainer, entity, loser), ~. %in% Oceania),
    contains_africa = if_any(c(gainer, entity, loser), ~. %in% Africa),
    contains_middle_east = if_any(c(gainer, entity, loser), ~. %in% Middle_East),
    contains_asia = if_any(c(gainer, entity, loser), ~. %in% Asia),
    contains_south_east_asia = if_any(c(gainer, entity, loser), ~. %in% Southeast_Asia),
    contains_europe = if_any(c(gainer, entity, loser), ~. %in% Europe),
    contains_south_america = if_any(c(gainer, entity, loser), ~. %in% South_America),
    contains_north_america = if_any(c(gainer, entity, loser), ~. %in% North_America),
    island_state = if_any(c(gainer, entity, loser), ~. %in% Island_States)
  ) |> 
  ungroup()
```

```{r}
data_graph <- data |> filter(island_state == T) |> mutate(
  entity = if_else(entity == gainer, " ", entity)
)

graph <- igraph::graph_from_data_frame(data_graph, directed = TRUE, vertices = NULL)

#maybe add independence here or something interesting
## figure out a way to deal with entity and loser the same

plot.igraph(graph,
            edge.label = data_graph$entity,
vertex.size = 4,
edge.color = 'grey20',
edge.arrow.size = .3,
main = 'Gainers and losers of territory with island states involved 1816 - 2015')

#cases where contiguity == 0 and military conflict is involved
# Dyads of countries engaged in military conflict despite not being contiguous exhibit distinct network structures compared to contiguous dyads.
# countries who've experiuenced "far away" military intervention are more likely to afterwards experience conflict with immediate neighbours
```


## Task 2

On the selected data, make a table that contains descriptive network statistics for the network and for key node-level variables. Please mention the historical period covered, the nature of tie(s), the number of nodes and ties, average degree, density, the standard deviation of degrees (or outdegrees and of indegrees if network is directed), and average path length. Identify the number of isolates if there are any. Please check if the network is a single component. Which node has the highest degree, and which has the highest betweenness centrality? What do these measures represent in terms of the specific type of relations and data you have selected?

```{r}

```


## Task 3 

Visualize the network. Vary degree color and size according to key node attributes. Try to pick a node attribute that relates to an important characteristic (e.g., power, GDP per capita).

```{r}

```

## Task 4

Implement and compare the results (community compositions, their size) of TWO different community detection algorithms to find communities (e.g., Girvan-Newman, Louvain, walktrap, cohesive blocks, Leiden). Please take into account that most of these methods can use undirected graphs only, others (such as Girvan-Newman) might work with weighted graphs. Before carrying out this task, simplify the data if necessary. Create a plot where nodes are either colored based on detected community membership, or you circulate the groups with some color in the background.

```{r}

```

## Task 5

Make meaningful comparisons between the results of community detection algorithms. Summarize the differences and similarities and try to explain these. Please refer to the relevant literature describing the logic of these algorithms if necessary. 

```{r}

```

